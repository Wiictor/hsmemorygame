var Card=function(t,i){this.card={o:t,rX:0,rY:0,tX:0,tY:0,scale:1},this.mouse={cx:0,cy:0,x:document.body.offsetWidth/2-t.offsetWidth/2,y:document.body.offsetHeight/2-t.offsetHeight/2,py:0,px:0,vx:0,vy:0,timer:null,moving:!1},this.speed=i&&i.speed?i.speed:6,this.offSpeed=i&&i.offSpeed?i.offSpeed:5,this.limit=i&&i.rotateLimit?i.rotateLimit:60,this.sensibility=i&&i.sensibility?i.sensibility:6,this.scaling=i&&i.scaling?i.scaling:!1,this.focus=!1,this.init()};Card.prototype.init=function(){this.bindClick(),this.card.x=this.mouse.x-this.card.o.offsetWidth/2,this.card.y=this.mouse.y-this.card.o.offsetHeight/2,this.start()},Card.prototype.bindClick=function(){this.bindmove=this.bindMove.bind(this),this.card.o.addEventListener("mousedown",this.bindmove)},Card.prototype.bindMove=function(){this.mouse.cx=event.layerX,this.mouse.cy=event.layerY,this.move=this.getMouseVars.bind(this),document.body.addEventListener("mousemove",this.move),this.stop=this.unbindMove.bind(this),document.body.addEventListener("mouseup",this.stop),this.focus=!0},Card.prototype.unbindMove=function(){document.body.removeEventListener("mousemove",this.move),document.body.removeEventListener("mouseup",this.stop),this.focus=!1,this.card.tX=0,this.card.tY=0},Card.prototype.getMouseVars=function(){this.mouse.moving=!0,this.mouse.py=this.mouse.y,this.mouse.px=this.mouse.x,this.mouse.y=event.pageY,this.mouse.x=event.pageX,this.mouse.vx=this.mouse.x-this.mouse.px,this.mouse.vy=this.mouse.y-this.mouse.py,this.mstop=this.mouseStop.bind(this),clearTimeout(this.mouse.timer),this.mouse.timer=setTimeout(this.mstop,10)},Card.prototype.mouseStop=function(){this.mouse.moving=!1,this.mouse.vx=0,this.mouse.vy=0},Card.prototype.getRotation=function(){this.card.tX=this.mouse.vx*this.sensibility,this.card.tY=this.mouse.vy*this.sensibility,this.card.tX>this.limit?this.card.tX=this.limit:this.card.tX<-this.limit&&(this.card.tX=-this.limit),this.card.tY>this.limit?this.card.tY=this.limit:this.card.tY<-this.limit&&(this.card.tY=-this.limit),this.card.x=this.mouse.x-this.mouse.cx,this.card.y=this.mouse.y-this.mouse.cy},Card.prototype.updateRotation=function(){var t=this.mouse.moving?this.speed:this.offSpeed;this.card.rX>this.card.tX+t||this.card.rX<this.card.tX-t?this.card.rX+=this.card.rX>this.card.tX?-t:t:(this.card.rX>this.card.tX+t/10||this.card.rX<this.card.tX-t/10)&&(this.card.rX+=this.card.rX>this.card.tX?-(t/10):t/10),this.card.rY>this.card.tY+t||this.card.rY<this.card.tY-t?this.card.rY+=this.card.rY>this.card.tY?-t:t:(this.card.rY>this.card.tY+t/10||this.card.rY<this.card.tY-t/10)&&(this.card.rY+=this.card.rY>this.card.tY?-(t/10):t/10)},Card.prototype.updateScale=function(){this.focus&&this.card.scale<1.1?this.card.scale+=.03:!this.focus&&this.card.scale>1&&(this.card.scale-=.03)},Card.prototype.update=function(){this.scaling&&this.updateScale(),this.getRotation(),this.updateRotation()},Card.prototype.draw=function(){this.card.left="left: "+this.card.x+"px; ",this.card.top="top: "+this.card.y+"px; ",this.card.transform="transform: ",this.card.transform+="rotateY("+this.card.rX+"deg) ",this.card.transform+="rotateX("+-this.card.rY+"deg) ",this.scaling&&(this.card.transform+="scale("+this.card.scale+");"),this.card.o.setAttribute("style",this.card.left+this.card.top+this.card.transform)},Card.prototype.start=function(){this.running=!0,this.run()},Card.prototype.stop=function(){this.running=!1},Card.prototype.run=function(){this.update(),this.draw(),loop=this.run.bind(this),this.running&&requestAnimationFrame(loop)};